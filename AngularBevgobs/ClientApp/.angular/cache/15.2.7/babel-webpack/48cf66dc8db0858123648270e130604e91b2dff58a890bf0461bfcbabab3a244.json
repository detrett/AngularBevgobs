{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from '@angular/core';\nlet CommentComponent = class CommentComponent {\n  constructor(_router, _commentService, _userService, _threadService, authService) {\n    this._router = _router;\n    this._commentService = _commentService;\n    this._userService = _userService;\n    this._threadService = _threadService;\n    this.authService = authService;\n    this.userDataLoaded = false;\n    this.currentUser = null;\n  }\n  ngAfterViewInit() {\n    // Bootstrap tooltip initialization\n    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle=\"tooltip\"]'));\n    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {\n      return new bootstrap.Tooltip(tooltipTriggerEl);\n    });\n  }\n  getAuthor() {\n    console.log(\"Comment Component: getAuthor()\");\n    if (this.comment?.UserId != null) {\n      this._userService.getUserById(this.comment?.UserId).subscribe(data => {\n        console.log('Data received: ', JSON.stringify(data));\n        this.author = data;\n      });\n    }\n  }\n  getThread() {\n    console.log(\"Comment Component: getThread()\");\n    if (this.comment?.ThreadId != null) {\n      this._threadService.getThreadById(this.comment?.ThreadId).subscribe(data => {\n        console.log('Data received: ', JSON.stringify(data));\n        this.thread = data;\n      });\n    }\n  }\n  getFormattedDate() {\n    console.log(\"Comment Component: getFormattedDate()\");\n    console.log(\"Last comment ID: \" + this.comment?.CreatedAt);\n    if (!this.comment?.CreatedAt) {\n      return \"Undefined date\";\n    } else {\n      const createdDate = new Date(this.comment?.CreatedAt);\n      const now = new Date();\n      const ts = now.getTime() - createdDate.getTime();\n      const minutes = Math.floor(ts / 60000);\n      const hours = Math.floor(ts / 3600000);\n      const days = Math.floor(ts / (3600000 * 24));\n      if (minutes < 2) return '1 minute ago';\n      if (hours < 1) return `${minutes} minutes ago`;\n      if (days < 1) return hours >= 2 ? `${hours} hours ago` : '1 hour ago';\n      if (days < 2) return 'yesterday';\n      if (days < 5) return `on ${createdDate.getDay()}`;\n      return `on ${createdDate.toLocaleDateString('en-UK', {\n        day: 'numeric',\n        month: 'long'\n      })}`;\n    }\n  }\n  get authorJoinDate() {\n    if (!this.author?.CreatedAt) {\n      return \"Undefined date\";\n    } else {\n      const date = new Date(this.author?.CreatedAt);\n      return date.toLocaleDateString('en-UK', {\n        day: 'numeric',\n        month: 'short',\n        year: 'numeric'\n      });\n    }\n  }\n  get commentTitle() {\n    console.log(\"Comment Component: commentTitle()\");\n    if (this.comment?.Title != null) {\n      return this.comment?.Title;\n    } else return this.thread?.Name;\n  }\n  ngOnInit() {\n    console.log(\"Comment Component: ngOnInit()\");\n    this.getAuthor();\n    this.getThread();\n    const userId = localStorage.getItem('userId');\n    if (userId) {\n      this.authService.getUserDetails(+userId).subscribe({\n        next: user => {\n          this.currentUser = user;\n          console.log('Current user:', this.currentUser);\n          this.userDataLoaded = true;\n        },\n        error: err => {\n          console.error('Error fetching user details:', err);\n        }\n      });\n    } else {\n      console.error('User ID not found in local storage');\n    }\n  }\n  get isAuthenticated() {\n    return this.authService.isAuthenticated();\n  }\n  get isAuthorOrMod() {\n    console.log(\"Current user: \" + this.currentUser);\n    if (this.author?.Rank == \"Admin\" || this.author?.Rank == \"Mod\" || this.currentUser.Username == this.author?.Username) {\n      return true;\n    } else return false;\n  }\n  logout() {\n    this.authService.logout();\n  }\n};\n__decorate([Input()], CommentComponent.prototype, \"comment\", void 0);\nCommentComponent = __decorate([Component({\n  selector: 'app-comment',\n  templateUrl: './comment.component.html',\n  styleUrls: ['./comment.component.css']\n})], CommentComponent);\nexport { CommentComponent };","map":{"version":3,"mappings":"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","names":["Component","Input","CommentComponent","constructor","_router","_commentService","_userService","_threadService","authService","ngAfterViewInit","tooltipTriggerList","slice","call","document","querySelectorAll","tooltipList","map","tooltipTriggerEl","bootstrap","Tooltip","getAuthor","console","log","comment","UserId","getUserById","subscribe","data","JSON","stringify","author","getThread","ThreadId","getThreadById","thread","getFormattedDate","CreatedAt","createdDate","Date","now","ts","getTime","minutes","Math","floor","hours","days","getDay","toLocaleDateString","day","month","authorJoinDate","date","year","commentTitle","Title","Name","ngOnInit","userId","localStorage","getItem","getUserDetails","next","user","currentUser","userDataLoaded","error","err","isAuthenticated","isAuthorOrMod","Rank","Username","logout","__decorate","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["D:\\VisualStudio\\source\\repos\\AngularBevgobs\\AngularBevgobs\\ClientApp\\src\\app\\comment\\comment.component.ts"],"sourcesContent":["import { Component, OnInit, Input, AfterViewInit } from '@angular/core';\r\nimport { IComment } from '../comment/comment';\r\nimport { IUser } from '../user/user';\r\nimport { IThread } from '../thread/thread';\r\nimport { Router } from '@angular/router';\r\nimport { CommentService } from '../comment/comment.service';\r\nimport { UserService } from '../user/user.service';\r\nimport { ThreadService } from '../thread/thread.service';\r\nimport { AuthService } from 'src/app/services/authentication.service';\r\ndeclare var bootstrap: any;\r\n\r\n@Component({\r\n  selector: 'app-comment',\r\n  templateUrl: './comment.component.html',\r\n  styleUrls: ['./comment.component.css']\r\n})\r\n\r\nexport class CommentComponent implements OnInit, AfterViewInit {\r\n  @Input() comment?: IComment;\r\n  userDataLoaded: boolean = false;\r\n  author?: IUser;\r\n  thread?: IThread;\r\n\r\n  currentUser: any = null;\r\n\r\n  constructor(\r\n    private _router: Router,\r\n    private _commentService: CommentService,\r\n    private _userService: UserService,\r\n    private _threadService: ThreadService,\r\n    private authService: AuthService) { }\r\n\r\n  ngAfterViewInit(): void {\r\n    // Bootstrap tooltip initialization\r\n    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle=\"tooltip\"]'))\r\n    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {\r\n      return new bootstrap.Tooltip(tooltipTriggerEl)\r\n    })\r\n  }\r\n\r\n  getAuthor(): void {\r\n    console.log(\"Comment Component: getAuthor()\");\r\n\r\n    if (this.comment?.UserId != null) {\r\n      this._userService.getUserById(this.comment?.UserId)\r\n        .subscribe(data => {\r\n          console.log('Data received: ', JSON.stringify(data));\r\n          this.author = data;\r\n          \r\n        })\r\n    }\r\n\r\n  }\r\n\r\n  getThread(): void {\r\n    console.log(\"Comment Component: getThread()\");\r\n\r\n    if (this.comment?.ThreadId != null) {\r\n      this._threadService.getThreadById(this.comment?.ThreadId)\r\n        .subscribe(data => {\r\n          console.log('Data received: ', JSON.stringify(data));\r\n          this.thread = data;\r\n        })\r\n    }\r\n  }\r\n\r\n  getFormattedDate(): string {\r\n\r\n    console.log(\"Comment Component: getFormattedDate()\");\r\n    console.log(\"Last comment ID: \" + this.comment?.CreatedAt);\r\n\r\n    if (!this.comment?.CreatedAt) {\r\n      return \"Undefined date\"\r\n    } else {\r\n      const createdDate = new Date(this.comment?.CreatedAt);\r\n\r\n      const now = new Date();\r\n      const ts = now.getTime() - createdDate.getTime();\r\n      const minutes = Math.floor(ts / 60000);\r\n      const hours = Math.floor(ts / 3600000);\r\n      const days = Math.floor(ts / (3600000 * 24));\r\n\r\n      if (minutes < 2) return '1 minute ago';\r\n      if (hours < 1) return `${minutes} minutes ago`;\r\n      if (days < 1) return hours >= 2 ? `${hours} hours ago` : '1 hour ago';\r\n      if (days < 2) return 'yesterday';\r\n      if (days < 5) return `on ${createdDate.getDay()}`;\r\n      return `on ${createdDate.toLocaleDateString('en-UK', { day: 'numeric', month: 'long' })}`;\r\n    }\r\n  }\r\n\r\n  get authorJoinDate() {\r\n    if (!this.author?.CreatedAt) {\r\n      return \"Undefined date\"\r\n    } else {\r\n      const date = new Date(this.author?.CreatedAt);\r\n      return date.toLocaleDateString('en-UK', { day: 'numeric', month: 'short', year:'numeric' });\r\n    }\r\n  }\r\n\r\n  get commentTitle() {\r\n    console.log(\"Comment Component: commentTitle()\");\r\n    if (this.comment?.Title != null) {\r\n      return this.comment?.Title;\r\n    } else return this.thread?.Name;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    console.log(\"Comment Component: ngOnInit()\");\r\n\r\n    this.getAuthor();\r\n    this.getThread();\r\n\r\n    const userId = localStorage.getItem('userId');\r\n    if (userId) {\r\n      this.authService.getUserDetails(+userId).subscribe({\r\n        next: (user) => {\r\n          this.currentUser = user;\r\n          console.log('Current user:', this.currentUser);\r\n          this.userDataLoaded = true;\r\n        },\r\n        error: (err) => {\r\n          console.error('Error fetching user details:', err);\r\n        }\r\n      });\r\n    } else {\r\n      console.error('User ID not found in local storage');\r\n    }\r\n    \r\n  }\r\n\r\n  get isAuthenticated(): boolean {\r\n    return this.authService.isAuthenticated();\r\n  }\r\n\r\n  get isAuthorOrMod(): boolean {\r\n    console.log(\"Current user: \" + this.currentUser)\r\n    if (this.author?.Rank == \"Admin\" || this.author?.Rank == \"Mod\" || this.currentUser.Username == this.author?.Username) {\r\n      return true;\r\n    } else return false;\r\n  }\r\n\r\n  logout() {\r\n    this.authService.logout();\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}