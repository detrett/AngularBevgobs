{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { of } from 'rxjs';\nimport { map, catchError, debounceTime } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/authentication.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nexport class RegisterComponent {\n  constructor(authService, router, formBuilder) {\n    this.authService = authService;\n    this.router = router;\n    this.formBuilder = formBuilder;\n  }\n  ngOnInit() {\n    this.registerForm = this.formBuilder.group({\n      username: ['', [Validators.required], [this.usernameValidator()]],\n      email: ['', [Validators.required, Validators.email]],\n      password: ['', [Validators.required, Validators.minLength(8)]],\n      confirmPassword: ['', [Validators.required]]\n    }, {\n      validator: this.matchPassword\n    });\n  }\n  matchPassword(group) {\n    const passwordControl = group.get('password');\n    const confirmPasswordControl = group.get('confirmPassword');\n    if (!passwordControl || !confirmPasswordControl) {\n      return {\n        invalidForm: true\n      };\n    }\n    const password = passwordControl.value;\n    const confirmPassword = confirmPasswordControl.value;\n    return password === confirmPassword ? null : {\n      notMatching: true\n    };\n  }\n  usernameValidator() {\n    return control => {\n      if (!control.value) {\n        return of(null);\n      }\n      // Replace this with your actual username availability check logic\n      return this.authService.checkUsernameAvailability(control.value).pipe(debounceTime(500), map(isAvailable => isAvailable ? null : {\n        alreadyTaken: true\n      }), catchError(() => of(null)));\n    };\n  }\n  onRegister() {\n    if (this.registerForm.valid) {\n      this.authService.register(this.registerForm.value).subscribe(data => {\n        console.log('Registration successful', data);\n        localStorage.setItem('token', data.token);\n        this.router.navigate(['/']);\n      }, error => {\n        console.error('Registration failed', error);\n      });\n    }\n  }\n  static #_ = this.ɵfac = function RegisterComponent_Factory(t) {\n    return new (t || RegisterComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RegisterComponent,\n    selectors: [[\"app-register\"]],\n    decls: 37,\n    vars: 5,\n    consts: [[2, \"display\", \"flex\", \"justify-content\", \"center\", \"align-items\", \"center\", \"min-height\", \"100vh\", \"padding\", \"20px\"], [1, \"register-card\", 2, \"max-width\", \"2000px\", \"margin\", \"auto\", \"width\", \"100%\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"col-12\", \"mb-5\"], [1, \"col-5\", \"border-pink\", \"rounded\", \"m-20\", \"background-light\", \"card\", \"pb-2\"], [3, \"ngSubmit\"], [\"registerForm\", \"ngForm\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"h3\", \"mb-3\", \"mt-4\", \"std-color\"], [1, \"form-floating\", \"mb-2\"], [\"type\", \"text\", \"name\", \"username\", \"required\", \"\", 1, \"form-control\", \"custom-form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-label\", \"custom-form-label\"], [1, \"fa-regular\", \"fa-user\"], [\"type\", \"email\", \"name\", \"email\", \"required\", \"\", 1, \"form-control\", \"custom-form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"fa-regular\", \"fa-envelope\"], [\"type\", \"password\", \"name\", \"password\", \"required\", \"\", 1, \"form-control\", \"custom-form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"fa-solid\", \"fa-key\"], [\"type\", \"password\", \"name\", \"confirmPassword\", \"required\", \"\", 1, \"form-control\", \"custom-form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"d-flex\"], [\"type\", \"submit\", 1, \"mb-5\", \"login-pink-btn\", \"m-auto\", 3, \"disabled\"]],\n    template: function RegisterComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"form\", 4, 5);\n        i0.ɵɵlistener(\"ngSubmit\", function RegisterComponent_Template_form_ngSubmit_4_listener() {\n          return ctx.onRegister();\n        });\n        i0.ɵɵelementStart(6, \"div\", 6)(7, \"h1\", 7);\n        i0.ɵɵtext(8, \"Create a new account\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(9, \"hr\");\n        i0.ɵɵelementStart(10, \"div\", 8)(11, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function RegisterComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.registerData.username = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"label\", 10);\n        i0.ɵɵelement(13, \"i\", 11);\n        i0.ɵɵelementStart(14, \"span\");\n        i0.ɵɵtext(15, \"Username\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"div\", 8)(17, \"input\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function RegisterComponent_Template_input_ngModelChange_17_listener($event) {\n          return ctx.registerData.email = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"label\", 10);\n        i0.ɵɵelement(19, \"i\", 13);\n        i0.ɵɵelementStart(20, \"span\");\n        i0.ɵɵtext(21, \"E-mail\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(22, \"div\", 8)(23, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function RegisterComponent_Template_input_ngModelChange_23_listener($event) {\n          return ctx.registerData.password = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"label\", 10);\n        i0.ɵɵelement(25, \"i\", 15);\n        i0.ɵɵelementStart(26, \"span\");\n        i0.ɵɵtext(27, \"Password\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"div\", 8)(29, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function RegisterComponent_Template_input_ngModelChange_29_listener($event) {\n          return ctx.registerData.confirmPassword = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"label\", 10);\n        i0.ɵɵelement(31, \"i\", 15);\n        i0.ɵɵelementStart(32, \"span\");\n        i0.ɵɵtext(33, \"Repeat password\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(34, \"div\", 17)(35, \"button\", 18);\n        i0.ɵɵtext(36, \"Register\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(5);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngModel\", ctx.registerData.username);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.registerData.email);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.registerData.password);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.registerData.confirmPassword);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"disabled\", !_r0.valid);\n      }\n    },\n    dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["Validators","of","map","catchError","debounceTime","RegisterComponent","constructor","authService","router","formBuilder","ngOnInit","registerForm","group","username","required","usernameValidator","email","password","minLength","confirmPassword","validator","matchPassword","passwordControl","get","confirmPasswordControl","invalidForm","value","notMatching","control","checkUsernameAvailability","pipe","isAvailable","alreadyTaken","onRegister","valid","register","subscribe","data","console","log","localStorage","setItem","token","navigate","error","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["/Users/brageeilertsen/RiderProjects/AngularBevgobs1/AngularBevgobs/ClientApp/src/app/register/register.component.ts","/Users/brageeilertsen/RiderProjects/AngularBevgobs1/AngularBevgobs/ClientApp/src/app/register/register.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {FormBuilder, FormGroup, Validators, AsyncValidatorFn, AbstractControl, ValidationErrors} from '@angular/forms';\nimport { AuthService } from 'src/app/services/authentication.service';\nimport { Observable, of } from 'rxjs';\nimport { map, catchError, debounceTime } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-register',\n  templateUrl: './register.component.html',\n  styleUrls: ['./register.component.css']\n})\nexport class RegisterComponent {\n  registerForm!: FormGroup;\n\n  constructor(\n    private authService: AuthService,\n    private router: Router,\n    private formBuilder: FormBuilder\n  ) {}\n\n  ngOnInit() {\n    this.registerForm = this.formBuilder.group({\n      username: ['', [Validators.required], [this.usernameValidator()]],\n      email: ['', [Validators.required, Validators.email]],\n      password: ['', [Validators.required, Validators.minLength(8)]],\n      confirmPassword: ['', [Validators.required]]\n    }, { validator: this.matchPassword });\n  }\n\n  matchPassword(group: FormGroup): ValidationErrors | null {\n    const passwordControl = group.get('password');\n    const confirmPasswordControl = group.get('confirmPassword');\n\n    if (!passwordControl || !confirmPasswordControl) {\n      return { invalidForm: true };\n    }\n\n    const password = passwordControl.value;\n    const confirmPassword = confirmPasswordControl.value;\n\n    return password === confirmPassword ? null : { notMatching: true };\n  }\n\n  usernameValidator(): AsyncValidatorFn {\n    return (control: AbstractControl): Observable<ValidationErrors | null> => {\n      if (!control.value) {\n        return of(null);\n      }\n      // Replace this with your actual username availability check logic\n      return this.authService.checkUsernameAvailability(control.value).pipe(\n        debounceTime(500),\n        map(isAvailable => (isAvailable ? null : { alreadyTaken: true })),\n        catchError(() => of(null))\n      );\n    };\n  }\n\n  onRegister() {\n    if (this.registerForm.valid) {\n      this.authService.register(this.registerForm.value).subscribe(\n        data => {\n          console.log('Registration successful', data);\n          localStorage.setItem('token', data.token);\n          this.router.navigate(['/']);\n        },\n        error => {\n          console.error('Registration failed', error);\n        }\n      );\n    }\n  }\n}\n","<div style=\"display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px;\">\n  <section class=\"register-card\" style=\"max-width: 2000px; margin: auto; width: 100%;\">\n  <div class=\"row d-flex justify-content-center col-12 mb-5\">\n    <div class=\"col-5 border-pink rounded m-20 background-light card pb-2\">\n\n      <form #registerForm=\"ngForm\" (ngSubmit)=\"onRegister()\">\n\n        <div class=\"d-flex justify-content-center\">\n          <h1 class=\"h3 mb-3 mt-4 std-color\">Create a new account</h1>\n        </div>\n\n        <hr />\n\n        <!-- Username -->\n        <div class=\"form-floating mb-2\">\n          <input type=\"text\" class=\"form-control custom-form-control\"\n                 [(ngModel)]=\"registerData.username\" name=\"username\" required>\n          <label class=\"form-label custom-form-label\">\n            <i class=\"fa-regular fa-user\"></i>\n            <span>Username</span>\n          </label>\n        </div>\n\n        <!-- Email -->\n        <div class=\"form-floating mb-2\">\n          <input type=\"email\" class=\"form-control custom-form-control\"\n                 [(ngModel)]=\"registerData.email\" name=\"email\" required>\n          <label class=\"form-label custom-form-label\">\n            <i class=\"fa-regular fa-envelope\"></i>\n            <span>E-mail</span>\n          </label>\n        </div>\n\n        <!-- Password -->\n        <div class=\"form-floating mb-2\">\n          <input type=\"password\" class=\"form-control custom-form-control\"\n                 [(ngModel)]=\"registerData.password\" name=\"password\" required>\n          <label class=\"form-label custom-form-label\">\n            <i class=\"fa-solid fa-key\"></i>\n            <span>Password</span>\n          </label>\n        </div>\n\n        <!-- Confirm Password -->\n        <div class=\"form-floating mb-2\">\n          <input type=\"password\" class=\"form-control custom-form-control\"\n                 [(ngModel)]=\"registerData.confirmPassword\" name=\"confirmPassword\" required>\n          <label class=\"form-label custom-form-label\">\n            <i class=\"fa-solid fa-key\"></i>\n            <span>Repeat password</span>\n          </label>\n        </div>\n\n        <div class=\"d-flex\">\n          <button type=\"submit\" class=\"mb-5 login-pink-btn m-auto\" [disabled]=\"!registerForm.valid\">Register</button>\n        </div>\n\n      </form>\n\n    </div>\n  </div>\n  </section>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}