{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet UserSettingsComponent = class UserSettingsComponent {\n  constructor(authService, formBuilder) {\n    this.authService = authService;\n    this.formBuilder = formBuilder;\n    // Initialize currentUser with default values to avoid null/undefined issues\n    this.currentUser = {\n      email: '',\n      username: '',\n      id: null\n      // Add other properties if necessary\n    };\n\n    this.loading = false;\n    this.errorMessage = '';\n  }\n  ngOnInit() {\n    this.initializeForm();\n    this.loadCurrentUser();\n  }\n  loadCurrentUser() {\n    const userId = localStorage.getItem('userId');\n    if (userId) {\n      this.authService.getUserDetails(+userId).subscribe({\n        next: user => {\n          this.currentUser = user;\n          this.updateFormValues(user);\n        },\n        error: err => {\n          console.error('Error fetching user details:', err);\n        }\n      });\n    } else {\n      console.error('User ID not found in local storage');\n    }\n  }\n  initializeForm() {\n    this.settingsForm = this.formBuilder.group({\n      email: ['', [Validators.required, Validators.email]],\n      username: ['', Validators.required],\n      password: ['', [Validators.minLength(8)]]\n    });\n  }\n  updateFormValues(user) {\n    this.settingsForm.patchValue({\n      email: user.email,\n      username: user.username\n      // Update other form controls here if needed\n    });\n  }\n\n  onProfilePictureChange(event) {\n    // Handle profile picture change here\n  }\n  onUpdateSettings() {\n    if (this.settingsForm.valid) {\n      this.loading = true;\n      const updatedUserData = {\n        ...this.settingsForm.value,\n        id: this.currentUser.id // Ensure the user ID is included\n      };\n\n      this.authService.updateUserDetails(this.currentUser.id, updatedUserData).subscribe({\n        next: response => {\n          console.log('User settings updated', response);\n          this.loading = false;\n          // Update currentUser with new details\n          this.currentUser = {\n            ...this.currentUser,\n            ...updatedUserData\n          };\n        },\n        error: err => {\n          this.errorMessage = 'Error updating user settings';\n          console.error('Error updating user settings:', err);\n          this.loading = false;\n        }\n      });\n    }\n  }\n};\nUserSettingsComponent = __decorate([Component({\n  selector: 'app-user-settings',\n  templateUrl: './user-settings.component.html',\n  styleUrls: ['./user-settings.component.css']\n})], UserSettingsComponent);\nexport { UserSettingsComponent };","map":{"version":3,"mappings":"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","names":["Component","Validators","UserSettingsComponent","constructor","authService","formBuilder","email","username","id","ngOnInit","initializeForm","loadCurrentUser","userId","localStorage","getItem","getUserDetails","subscribe","next","user","currentUser","updateFormValues","error","err","console","settingsForm","group","required","password","minLength","patchValue","onProfilePictureChange","event","onUpdateSettings","valid","loading","updatedUserData","value","updateUserDetails","response","log","errorMessage","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/Users/brageeilertsen/RiderProjects/AngularBevgobs1/AngularBevgobs/ClientApp/src/app/user-settings/user-settings.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { AuthService } from 'src/app/services/authentication.service';\n\n@Component({\n  selector: 'app-user-settings',\n  templateUrl: './user-settings.component.html',\n  styleUrls: ['./user-settings.component.css']\n})\nexport class UserSettingsComponent implements OnInit {\n  // Initialize currentUser with default values to avoid null/undefined issues\n  currentUser: any = {\n    email: '',\n    username: '',\n    id: null,\n    // Add other properties if necessary\n  };\n  settingsForm!: FormGroup;\n  loading = false;\n  errorMessage: string = '';\n\n  constructor(\n    private authService: AuthService,\n    private formBuilder: FormBuilder\n  ) {}\n\n  ngOnInit() {\n    this.initializeForm();\n    this.loadCurrentUser();\n  }\n\n  private loadCurrentUser() {\n    const userId = localStorage.getItem('userId');\n    if (userId) {\n      this.authService.getUserDetails(+userId).subscribe({\n        next: (user) => {\n          this.currentUser = user;\n          this.updateFormValues(user);\n        },\n        error: (err) => {\n          console.error('Error fetching user details:', err);\n        }\n      });\n    } else {\n      console.error('User ID not found in local storage');\n    }\n  }\n\n  private initializeForm() {\n    this.settingsForm = this.formBuilder.group({\n      email: ['', [Validators.required, Validators.email]],\n      username: ['', Validators.required],\n      password: ['', [Validators.minLength(8)]]\n    });\n  }\n\n  private updateFormValues(user: any) {\n    this.settingsForm.patchValue({\n      email: user.email,\n      username: user.username\n      // Update other form controls here if needed\n    });\n  }\n\n  onProfilePictureChange(event: any) {\n    // Handle profile picture change here\n  }\n\n  onUpdateSettings() {\n    if (this.settingsForm.valid) {\n      this.loading = true;\n      const updatedUserData = {\n        ...this.settingsForm.value,\n        id: this.currentUser.id // Ensure the user ID is included\n      };\n\n      this.authService.updateUserDetails(this.currentUser.id, updatedUserData).subscribe({\n        next: (response) => {\n          console.log('User settings updated', response);\n          this.loading = false;\n          // Update currentUser with new details\n          this.currentUser = {\n            ...this.currentUser,\n            ...updatedUserData\n          };\n        },\n        error: (err) => {\n          this.errorMessage = 'Error updating user settings';\n          console.error('Error updating user settings:', err);\n          this.loading = false;\n        }\n      });\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}